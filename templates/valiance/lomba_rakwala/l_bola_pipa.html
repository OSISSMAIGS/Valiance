{% extends "valiance/layout.html" %} {% block css_js %}
<link
  rel="stylesheet"
  type="text/css"
  href="{{ url_for('static', filename='valiance/css/index.css') }}"
/>
<link
  rel="stylesheet"
  type="text/css"
  href="{{ url_for('static', filename='valiance/css/lomba_rakwala.css') }}"
/>
<script
  src="{{ url_for('static', filename='valiance/js/e_questival.js') }}"
  defer
></script>

<script>
  let enableSend = true;
  document.addEventListener("DOMContentLoaded", () => {
    const scriptURL =
      "https://script.google.com/macros/s/AKfycbzGPgpNQ_AmybCML4asby9FSrG8GIelGhDFwKCDJrPhCySU66-nXb6sKCp550cZTDI/exec";
    const form = document.getElementById("dynamicForm");
    const formStatus = document.getElementById("formStatus");
    const popupOverlay = document.getElementById("popupOverlay");
    const closeButton = document.getElementById("closeButton");

    popupOverlay.addEventListener("click", function (e) {
      if (e.target === this) {
        closePopup();
      }
    });

    closeButton.addEventListener("click", closePopup);
    closeButton.addEventListener("touchend", function (e) {
      e.preventDefault();
      closePopup();
    });

    form.addEventListener("submit", (e) => {
      if (enableSend) {
        e.preventDefault();
        formStatus.textContent = "Mengirim data...";
        formStatus.className = "status";
        enableSend = false;
        const formData = new FormData(form);
        formData.append("formType", "Lomba Bola dan Pipa");

        fetch(scriptURL, { method: "POST", body: formData })
          .then((response) => response.json())
          .then((data) => {
            if (data.status === "success") {
              formStatus.textContent = "";
              form.reset();
              showPopup();
            } else if (
              data.status === "error" &&
              data.message === "Peserta sudah penuh"
            ) {
              formStatus.textContent =
                "Peserta sudah penuh. Tidak bisa mendaftar.";
              formStatus.className = "status error";
            } else {
              throw new Error(data.message || "Gagal mengirim data.");
            }
            enableSend = true;
          })
          .catch((error) => {
            formStatus.textContent = "Gagal mengirim data. Silakan coba lagi.";
            formStatus.className = "status error";
            console.error("Error!", error.message);
            enableSend = true;
          });
      }
    });
  });

  function showPopup() {
    document.getElementById("popupOverlay").style.display = "flex";
  }

  function closePopup() {
    document.getElementById("popupOverlay").style.display = "none";
  }
</script>
{% endblock css_js %} {% block title %}Lomba Bola Pipa{% endblock title %} {%
block main %}

<!-- MEKANISME DAN POSTER -->
<div class="container">
  <div>
    <h1 class="title">Lomba Bola Pipa</h1>
    <div class="mechanism">
      <h4 class="sub-title">MEKANISME PERTANDINGAN:</h4>
      <ol>
        <li>
          Lomba akan dimainkan oleh beberapa tim( 1 tim = 5 orang), sesuai sesi,
          dan diambil 1 tim untuk maju ke babak selanjutnya.
        </li>
        <li>Terdapat babak penyisihan dan babak final.</li>
        <li>
          Pada awal permainan para peserta akan mencoba untuk mengangkat pipa
          dengan tali tanpa menjatuhkan bola tersebut.
        </li>
        <li>
          Setelah dapat mengangkat bola tersebut para peserta akan memegang pipa
          dengan tali dan mengangkat pipa yang berisi bola ke garis akhir.
        </li>
        <li>
          Setelah sampai ke garis akhir para peserta akan mencoba untuk
          memasukkan bola ke dalam kardus yang telah di siapkan.
        </li>
        <li>
          Jika bola jatuh maka para peserta harus mengulang dari garis start.
        </li>
        <li>Setiap tim akan di beri waktu 3 - 5 menit.</li>
        <li>Lomba akan dilakukan secara berulang sampai waktu habis.</li>
        <li>
          Tim yang berhasil mengisi kardus dengan bola terbanyak akan lolos ke
          babak selanjutnya.
        </li>
        <li>
          Di babak final, akan di lakukan dengan mekanisme yang sama tetapi
          dengan jumlah bola yang lebih banyak dan waktu yang lebih.
        </li>
        <li>
          Tim yang mengisi bola paling banyak akan memenangkan lomba tersebut.
        </li>
      </ol>
    </div>
    <div class="rules">
      <h4 class="sub-title">RULES:</h4>
      <ol>
        <li>
          Setiap kelas wajib mengirimkan perwakilan sebanyak 5 siswa sebagai
          tim.
        </li>
        <li>
          Setiap peserta hanya diizinkan memegang tali dan bukan pipa PVC.
        </li>
        <li>Jika bola jatuh ke tanah, makan tim harus mengulang dari awal.</li>
        <li>
          Para peserta tidak diperbolehkan untuk memegang bola secara langsung
          ketika sedang memasukkan bola ke cup.
        </li>
        <li>Akan ada batas waktu pada setiap ronde.</li>
        <li>Segala bentuk kecurangan akan didiskualifikasi.</li>
      </ol>
    </div>
  </div>
  <img
    src="{{ url_for('static', filename='valiance/img/rakwala/l_bola_dan_pipa.jpg') }}"
    alt="Lomba Bola dan Pipa"
  />
</div>

<!-- Registration -->
<h2 class="regis">Registration</h2>
<div class="form-container mb-3">
  <form id="dynamicForm" onsubmit="return false;">
    <!-- 1 -->
    <div class="form-group">
      <label for="nama-ketua">Nama Ketua:</label>
      <input type="text" id="nama-ketua" name="nama-ketua" required />
    </div>

    <!-- 2 -->
    <div class="form-group">
      <label for="nama-anggota-1">Nama Anggota 1:</label>
      <input type="text" id="nama-anggota-1" name="nama-anggota-1" required />
    </div>

    <!-- 3 -->
    <div class="form-group">
      <label for="nama-anggota-2">Nama Anggota 2:</label>
      <input type="text" id="nama-anggota-2" name="nama-anggota-2" required />
    </div>

    <!-- 4 -->
    <div class="form-group">
      <label for="nama-anggota-3">Nama Anggota 3:</label>
      <input type="text" id="nama-anggota-3" name="nama-anggota-3" required />
    </div>

    <!-- 5 -->
    <div class="form-group">
      <label for="nama-anggota-4">Nama Anggota 4:</label>
      <input type="text" id="nama-anggota-4" name="nama-anggota-4" required />
    </div>

    <!-- Input Kelas -->
    <div class="form-group">
      <label for="kelas">Kelas:</label>
      <input type="text" id="kelas" name="kelas" required />
    </div>

    <!-- Input ID Line -->
    <div class="form-group">
      <label for="line">ID Line:</label>
      <input type="text" id="line" name="id-line" required />
    </div>

    <input
      type="hidden"
      id="maxParticipants"
      name="maxParticipants"
      value="16"
    />
    <button type="submit">Kirim</button>
  </form>
  <div class="status" id="formStatus"></div>
</div>

<!-- Popup Overlay -->
<div
  id="popupOverlay"
  style="
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.8);
    z-index: 9999;
    justify-content: center;
    align-items: center;
  "
>
  <div
    style="
      background: rgb(242, 177, 162);
      color: black;
      padding: 20px;
      border-radius: 10px;
      width: 90%;
      max-width: 400px;
      margin: 20px;
    "
  >
    <div class="modal-body">
      <p>Formulir berhasil dikirim! ðŸŽ‰</p>
      <a href="https://line.me/ti/g/AbKLeQy-3K" target="_blank"
        >Klik di sini untuk join grup Line</a
      >
      <br /><br />
    </div>
    <button
      id="closeButton"
      style="
        padding: 10px 20px;
        background: rgb(124, 28, 28);
        color: white;
        border: none;
        border-radius: 5px;
        cursor: pointer;
        margin-top: 10px;
        user-select: none;
        -webkit-user-select: none;
        -webkit-tap-highlight-color: transparent;
        touch-action: manipulation;
      "
    >
      Tutup
    </button>
  </div>
</div>
<svg
  class="waves-footer"
  xmlns="http://www.w3.org/2000/svg"
  viewBox="0 0 1440 320"
>
  <path
    fill-opacity="1"
    d="M0,64L60,101.3C120,139,240,213,360,240C480,267,600,245,720,240C840,235,960,245,1080,208C1200,171,1320,85,1380,42.7L1440,0L1440,320L1380,320C1320,320,1200,320,1080,320C960,320,840,320,720,320C600,320,480,320,360,320C240,320,120,320,60,320L0,320Z"
  ></path>
</svg>
{% endblock main %}
