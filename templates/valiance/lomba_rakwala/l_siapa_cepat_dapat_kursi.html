{% extends "valiance/layout.html" %} {% block css_js %}
<link
  rel="stylesheet"
  type="text/css"
  href="{{ url_for('static', filename='valiance/css/index.css') }}"
/>
<link
  rel="stylesheet"
  type="text/css"
  href="{{ url_for('static', filename='valiance/css/lomba_rakwala.css') }}"
/>
<script
  src="{{ url_for('static', filename='valiance/js/e_questival.js') }}"
  defer
></script>

<script>
  let enableSend = true;
  document.addEventListener("DOMContentLoaded", () => {
    const scriptURL =
      "https://script.google.com/macros/s/AKfycbzGPgpNQ_AmybCML4asby9FSrG8GIelGhDFwKCDJrPhCySU66-nXb6sKCp550cZTDI/exec";
    const form = document.getElementById("dynamicForm");
    const formStatus = document.getElementById("formStatus");
    const popupOverlay = document.getElementById("popupOverlay");
    const closeButton = document.getElementById("closeButton");

    popupOverlay.addEventListener("click", function (e) {
      if (e.target === this) {
        closePopup();
      }
    });

    closeButton.addEventListener("click", closePopup);
    closeButton.addEventListener("touchend", function (e) {
      e.preventDefault();
      closePopup();
    });

    form.addEventListener("submit", (e) => {
      if (enableSend) {
        e.preventDefault();
        formStatus.textContent = "Mengirim data...";
        formStatus.className = "status";
        enableSend = false;
        const formData = new FormData(form);
        formData.append("formType", "Lomba Siapa Cepat Dapat Kursi");

        fetch(scriptURL, { method: "POST", body: formData })
          .then((response) => response.json())
          .then((data) => {
            if (data.status === "success") {
              formStatus.textContent = "";
              form.reset();
              showPopup();
            } else if (
              data.status === "error" &&
              data.message === "Peserta sudah penuh"
            ) {
              formStatus.textContent =
                "Peserta sudah penuh. Tidak bisa mendaftar.";
              formStatus.className = "status error";
            } else {
              throw new Error(data.message || "Gagal mengirim data.");
            }
            enableSend = true;
          })
          .catch((error) => {
            formStatus.textContent = "Gagal mengirim data. Silakan coba lagi.";
            formStatus.className = "status error";
            console.error("Error!", error.message);
            enableSend = true;
          });
      }
    });
  });

  function showPopup() {
    document.getElementById("popupOverlay").style.display = "flex";
  }

  function closePopup() {
    document.getElementById("popupOverlay").style.display = "none";
  }
</script>
{% endblock css_js %} {% block title %}Lomba Siapa Cepat Dapat Kursi{% endblock
title %} {% block main %}

<!-- MEKANISME DAN POSTER -->
<div class="container">
  <div>
    <h1 class="title">Lomba Siapa Cepat Dapat Kursi</h1>
    <div class="mechanism">
      <h4 class="sub-title">MEKANISME PERTANDINGAN:</h4>
      <ol>
        <li>Setiap kelas wajib mengirimkan perwakilan 1 orang.</li>
        <li>Peserta akan dibagi menjadi 4 grup (1 grup berisi 10 orang).</li>
        <li>
          Lomba terdapat 2 sesi, setiap sesi akan ada 2 grup yang bermain (total
          keseluruhan peserta tiap sesi ada 20 orang).
        </li>
        <li>Setiap sesi, permainan akan dimainkan per grup.</li>
        <li>
          1 grup yang berisikan 10 orang akan disediakan 9 kursi, dan berlanjut
          hingga tersisa 3 orang dan 2 kursi.
        </li>
        <li>
          2 orang pertama yang mendapat kursi tersebut akan berlanjut ke babak
          final.
        </li>
        <li>
          Pada sesi pertama, grup A dan grup B akan bermain secara bersamaan,
          maka dari setiap 2 orang yang tersisa pada masing-masing grup per
          sesi, akan masuk ke babak final untuk memperoleh juara 1, 2, dan 3.
        </li>
        <li>
          Yang akan bermain di babak final ada 8 peserta dari babak sebelumnya.
          (2 dari grup A, 2 dari grup B, 2 dari grup C, 2 dari grup D).
        </li>
      </ol>
    </div>
    <div class="rules">
      <h4 class="sub-title">RULES:</h4>
      <ol>
        <li>Peserta dilarang menyentuh kursi sebelum musik berhenti.</li>
        <li>
          Peserta dilarang mendorong, menarik, atau membahayakan peserta lain.
        </li>
        <li>
          Peserta yang melakukan tindak kecurangan akan langsung di
          diskualifikasi dari permainan.
        </li>
        <li>
          Peserta harus terus berjalan selama musik diputar, tidak boleh berdiri
          diam di dekat kursi.
        </li>
        <li>Keputusan panitia bersifat mutlak.</li>
      </ol>
    </div>
  </div>
  <img
    src="{{ url_for('static', filename='valiance/img/rakwala/l_kursi.jpg') }}"
    alt="Lomba Siapa Cepat Dapat Kursi"
  />
</div>

<!-- Registration -->
<h2 class="regis">Registration</h2>
<div class="form-container mb-3">
  <form id="dynamicForm" onsubmit="return false;">
    <!-- 1 -->
    <div class="form-group">
      <label for="nama-ketua-kelompok">Nama Ketua Kelompok:</label>
      <input
        type="text"
        id="nama-ketua-kelompok"
        name="nama-ketua-kelompok"
        required
      />
    </div>

    <!-- Input Kelas -->
    <div class="form-group">
      <label for="kelas">Kelas:</label>
      <input type="text" id="kelas" name="kelas" required />
    </div>

    <!-- Input ID Line -->
    <div class="form-group">
      <label for="line">ID Line:</label>
      <input type="text" id="line" name="id-line" required />
    </div>

    <input
      type="hidden"
      id="maxParticipants"
      name="maxParticipants"
      value="9999"
    />
    <button type="submit">Kirim</button>
  </form>
  <div class="status" id="formStatus"></div>
</div>

<!-- Popup Overlay -->
<div
  id="popupOverlay"
  style="
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.8);
    z-index: 9999;
    justify-content: center;
    align-items: center;
  "
>
  <div
    style="
      background: rgb(242, 177, 162);
      color: black;
      padding: 20px;
      border-radius: 10px;
      width: 90%;
      max-width: 400px;
      margin: 20px;
    "
  >
    <div class="modal-body">
      <p>Formulir berhasil dikirim! ðŸŽ‰</p>
      <a href="https://line.me/R/ti/g/H82BA8UY7Z" target="_blank"
        >Klik di sini untuk join grup Line</a
      >
      <br /><br />
    </div>
    <button
      id="closeButton"
      style="
        padding: 10px 20px;
        background: rgb(124, 28, 28);
        color: white;
        border: none;
        border-radius: 5px;
        cursor: pointer;
        margin-top: 10px;
        user-select: none;
        -webkit-user-select: none;
        -webkit-tap-highlight-color: transparent;
        touch-action: manipulation;
      "
    >
      Tutup
    </button>
  </div>
</div>
<svg
  class="waves-footer"
  xmlns="http://www.w3.org/2000/svg"
  viewBox="0 0 1440 320"
>
  <path
    fill-opacity="1"
    d="M0,64L60,101.3C120,139,240,213,360,240C480,267,600,245,720,240C840,235,960,245,1080,208C1200,171,1320,85,1380,42.7L1440,0L1440,320L1380,320C1320,320,1200,320,1080,320C960,320,840,320,720,320C600,320,480,320,360,320C240,320,120,320,60,320L0,320Z"
  ></path>
</svg>
{% endblock main %}
